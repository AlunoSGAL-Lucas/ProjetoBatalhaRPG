<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Batalha RPG SuperGeeks - VersÃ£o Bootstrap</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="text-center p-4">

  <img src="imgs/logojojo.png" id="Logo" class="mb-4">

  <div class="container">
    <div class="row justify-content-center">

      <!-- Personagem -->
      <div class="col-md-4">
        <div id="cardpersonagem" class="card mb-3 shadow">
          <div class="card-body">
            <h3 class="card-title">ðŸŽ® Jogador</h3>
            <select id="personagemEscolhidoId" class="form-select my-2" onchange="selecionarPersonagem()"></select>
            <p>Vida: <span id="vidaPersonagemId" class="fw-bold"></span></p>
            <p>Dano: <span id="danoPersonagemId" class="fw-bold"></span></p>
            <img id="imagemPersonagemId" class="img-fluid rounded border border-dark" width="100" height="100">
          </div>
        </div>
      </div>

      <!-- Inimigo -->
      <div class="col-md-4">
        <div id="cardinimigo" class="card mb-3 shadow">
          <div class="card-body">
            <h3 class="card-title">ðŸ’€ AdversÃ¡rio</h3>
            <select id="selecaoInimigosId" class="form-select my-2" onchange="selecionarGrupo()"></select>
            <select id="inimigosEscolhidosId" class="form-select my-2" onchange="selecionarInimigo()"></select>
            <p>Vida: <span id="vidaInimigoId" class="fw-bold"></span></p>
            <p>Dano: <span id="danoInimigoId" class="fw-bold"></span></p>
            <img id="imagemInimigoId" class="img-fluid rounded border border-light" width="100" height="100">
          </div>
        </div>
      </div>
    </div>

    <!-- BotÃµes de aÃ§Ã£o -->
    <div class="my-3">
      <button class="btn btn-danger btn-lg me-2" onclick="atacar()">Atacar</button>
      <button id="botaoSaquearId" class="btn btn-warning btn-lg" onclick="saquear()" disabled>Saquear</button>
    </div>

    <!-- EvoluÃ§Ã£o -->
    <div id="evolutioncard" class="card mx-auto text-light" style="max-width: 400px;">
      <div class="card-body">
        <h3 class="card-title">ðŸŽ† EvoluÃ§Ã£o</h3>
        <p>Pontos: <span id="pontosEvolucaoid" class="fw-bold"></span></p>
        <button class="btn btn-success me-2" onclick="evoluir('vida')">Evoluir Vida</button>
        <button class="btn btn-primary" onclick="evoluir('dano')">Evoluir Dano</button>
      </div>
    </div>

    <p id="resultadoId" class="mt-4 fs-5 fw-bold text-info"></p>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Script principal -->
  <script>
    // ============================================================
    // =============== CONFIGURAÃ‡ÃƒO BASE ==========================
    // ============================================================

    const personagensBase = {
      Player1: {vida: 120, dano: 20, imagem: "/imgs/Player1.png"},   // equilibrado
      Player2: {vida: 100, dano: 25, imagem: "/imgs/Player2.png"},   // atacante
      Player3: {vida: 140, dano: 15, imagem: "/imgs/Player3.png"}    // tanque
    };

    const inimigosBase = {
      Inimigos_1: [
        {nome: "Inimigo 1", vida: 60, dano: 12, imagem: "/imgs/Inimigo1.png"},
        {nome: "Inimigo 2", vida: 75, dano: 15, imagem: "/imgs/Inimigo2.png"},
        {nome: "Inimigo 3", vida: 90, dano: 10, imagem: "/imgs/Inimigo3.png"}
      ],
      Inimigos_2: [
        {nome: "Inimigo 4", vida: 80, dano: 18, imagem: "/imgs/Inimigo4.png"},
        {nome: "Inimigo 5", vida: 100, dano: 22, imagem: "/imgs/Inimigo5.png"},
        {nome: "Inimigo 6", vida: 130, dano: 30, imagem: "/imgs/Inimigo6.png"}
      ]
    };

    class Personagem {
      constructor(nome, {vida, dano, imagem}) {
        this.nome = nome;
        this.vida = vida;
        this.dano = dano;
        this.imagem = imagem;
      }
      evoluir(atributo, pontos) {
        this[atributo] += pontos;
      }
    }

    let personagens = [];
    let inimigos = {};
    let personagemAtual;
    let inimigosGrupoAtual = [];
    let inimigoAtual;
    let pontosEvolucao = 1;
    const pontosPorEvolucao = 5;

    function criarPersonagens() {
      personagens = Object.entries(personagensBase)
        .map(([nome, dados]) => new Personagem(nome, dados));
      const opcoes = personagens.map((p, i) => `<option value="${i}">${p.nome}</option>`).join("");
      $("#personagemEscolhidoId").html(opcoes);
      personagemAtual = personagens[0];
    }

    function criarInimigos() {
      inimigos = Object.fromEntries(
        Object.entries(inimigosBase).map(([grupo, lista]) => [
          grupo,
          lista.map(i => new Personagem(i.nome, i))
        ])
      );
      const grupos = Object.keys(inimigos)
        .map(g => `<option value="${g}">${g}</option>`)
        .join("");
      $("#selecaoInimigosId").html(grupos);
      selecionarGrupo();
    }

    function selecionarPersonagem() {
      personagemAtual = personagens[$("#personagemEscolhidoId").val()];
      atualizarInterface();
    }

    function selecionarGrupo() {
      const grupo = $("#selecaoInimigosId").val();
      inimigosGrupoAtual = inimigos[grupo];
      const opcoes = inimigosGrupoAtual.map((i, idx) => `<option value="${idx}">${i.nome}</option>`).join("");
      $("#inimigosEscolhidosId").html(opcoes);
      selecionarInimigo();
    }

    function selecionarInimigo() {
      inimigoAtual = inimigosGrupoAtual[$("#inimigosEscolhidosId").val()];
      atualizarInterface();
    }

    function atacar() {
      if (personagemAtual.vida <= 0) return mostrarMsg(`${personagemAtual.nome} estÃ¡ morto!`);
      if (inimigoAtual.vida <= 0) return mostrarMsg(`${inimigoAtual.nome} jÃ¡ estÃ¡ morto!`);

      inimigoAtual.vida -= personagemAtual.dano;
      let msg = `${personagemAtual.nome} causou ${personagemAtual.dano} de dano em ${inimigoAtual.nome}. `;

      if (inimigoAtual.vida <= 0) {
        inimigoAtual.vida = 0;
        msg += `${inimigoAtual.nome} morreu! `;
      }

      if (inimigoAtual.vida > 0) {
        personagemAtual.vida -= inimigoAtual.dano;
        msg += `${inimigoAtual.nome} revidou e causou ${inimigoAtual.dano} de dano! `;
        if (personagemAtual.vida <= 0) {
          personagemAtual.vida = 0;
          msg += `${personagemAtual.nome} morreu! `;
        }
      }

      if (inimigosGrupoAtual.every(i => i.vida <= 0)) {
        $("#botaoSaquearId").attr("disabled", false);
        msg += "ðŸ† Todos os inimigos foram derrotados! Saqueie os pontos!";
      }

      mostrarMsg(msg);
      atualizarInterface();
    }

    function saquear() {
      pontosEvolucao++;
      $("#botaoSaquearId").attr("disabled", true);
      mostrarMsg("ðŸ’° VocÃª ganhou 1 ponto de evoluÃ§Ã£o!");
      atualizarInterface();
    }

    function evoluir(atributo) {
      if (pontosEvolucao > 0) {
        personagemAtual.evoluir(atributo, pontosPorEvolucao);
        pontosEvolucao--;
        mostrarMsg(`âœ¨ ${personagemAtual.nome} evoluiu +${pontosPorEvolucao} em ${atributo}!`);
        atualizarInterface();
      }
    }

    function atualizarInterface() {
      $("#vidaPersonagemId").text(personagemAtual.vida);
      $("#danoPersonagemId").text(personagemAtual.dano);
      $("#imagemPersonagemId").attr("src", personagemAtual.imagem);

      $("#vidaInimigoId").text(inimigoAtual.vida);
      $("#danoInimigoId").text(inimigoAtual.dano);
      $("#imagemInimigoId").attr("src", inimigoAtual.imagem);

      $("#pontosEvolucaoid").text(pontosEvolucao);
    }

    function mostrarMsg(msg) {
      $("#resultadoId").text(msg);
    }

    function iniciar() {
      criarPersonagens();
      criarInimigos();
      atualizarInterface();
    }

    $(document).ready(iniciar);
  </script>
</body>

</html>